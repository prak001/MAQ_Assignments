CREATE MATERIALIZED VIEW SalesByVendorDateKeyMV2012 BUILD IMMEDIATE REFRESH COMPLETE
ON DEMAND
AS
SELECT I.CUSTVENDORKEY AS CUSTVENDORKEY,
I.DATEKEY AS DATEKEY,
SUM(I.EXTCOST) AS TOTALEXTCOST,
SUM(I.QUANTITY) AS TOTALQUANTITY,
COUNT(*) AS TRANSACTIONCOUNT
FROM INVENTORY_FACT I
JOIN DATE_DIM D
ON I.DATEKEY = D.DATEKEY
WHERE I.TRANSTYPEKEY = 5
AND D.CALYEAR = 2012
GROUP BY I.CUSTVENDORKEY,
I.DATEKEY;