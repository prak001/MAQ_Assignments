SELECT D.CALMONTH,
CV.ADDRCATCODE1,
SUM(SMV.TOTALEXTCOST) AS TOTALEXTCOST,
SUM(SMV.TOTALQUANTITY) AS TOTALQUANTITY
FROM SALESBYVENDORDATEKEYMV2011 SMV
JOIN DATE_DIM D
ON SMV.DATEKEY = D.DATEKEY
JOIN CUST_VENDOR_DIM CV
ON SMV.CUSTVENDORKEY = CV.CUSTVENDORKEY
GROUP BY CUBE(D.CALMONTH, CV.ADDRCATCODE1)
ORDER BY D.CALMONTH,
CV.ADDRCATCODE1;